!function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(1),o=i(2),r=i(3),h=i(4),l=i(5),d=function(){function e(t,i){n(this,e),t&&(this.box=t,this.toolBarBox=i,this.data=[],this.eleIndex=0,this.lineIndex=0,this.childIndex=0,this.moveExecLength=0,this.moveSingleCharLen=24,this.paragraphIndent=4,this.paragraphLastIndent=4,this.textIndent=2,this.init(),this.initLine(),this.touch=new a(t,{click:this.handleClick.bind(this),move:this.handleTouchMove.bind(this),moveEnd:this.handleTouchEnd.bind(this)}))}return s(e,[{key:"init",value:function(){this._Selection=h,this.container=document.createElement("div"),this.container.setAttribute("class","medit-container"),this.box.appendChild(this.container)}},{key:"initLine",value:function(e){var t=document.createElement("p"),i=++this.eleIndex;if(t.setAttribute("data-meditIndex",i),t.style.paddingLeft=this.paragraphIndent+"em",t.style.paddingRight=this.paragraphLastIndent+"em",t.style.textIndent=this.textIndent+"em",null==e||e>=this.data.length)this.container.appendChild(t),this.data.push({ele:t,child:[],index:i}),this.lineIndex=this.data.length-1;else{var n=this.data[e].ele;this.container.insertBefore(t,n),this.data.splice(e,0,{ele:t,child:[],index:i}),this.lineIndex=e}}},{key:"handleClick",value:function(e){if(e.target==this.box)this.insertNewSpan(this.data[this.lineIndex].child);else{var t=r.getIndex(this.data,e.target);t&&(this.lineIndex=t.lineIndex,this.childIndex=t.childIndex)}}},{key:"handleTouchMove",value:function(e){var t=this.data[this.lineIndex].child[this.childIndex].ele,i=h.getCaretPos(t),n=parseInt((e.horizontalDistance-this.moveExecLength)/this.moveSingleCharLen);if(Math.abs(n)>=1){this.moveExecLength=e.horizontalDistance;var s=h.getElement(this.data,this.lineIndex,this.childIndex,n,i);s&&(this.lineIndex==s.lineIndex&&this.childIndex==s.childIndex||(this.data[this.lineIndex].child[this.childIndex].input.blur(),this.lineIndex=s.lineIndex,this.childIndex=s.childIndex,this.data[this.lineIndex].child[this.childIndex].input.focus()),h.setCaretPos(s.ele,s.pos))}}},{key:"handleTouchEnd",value:function(){this.moveExecLength=0}},{key:"inputBlur",value:function(){}},{key:"insertNewSpan",value:function(e){var t=this.initSpan(e);this.childIndex=this.data[this.lineIndex].child.length-1,t.isOld?this.data[this.lineIndex].child[this.childIndex].input.focus():(this.childIndex++,this.data[this.lineIndex].child.push(this.insertNewSpanInfo(t)),this.data[this.lineIndex].ele.appendChild(t.ele),this.data[this.lineIndex].child[this.childIndex].input.focus())}},{key:"insertNewSpanInfo",value:function(e){return{ele:e.ele,input:new o(e.ele,{blur:this.inputBlur.bind(this),enter:this.inputEnter.bind(this)}),index:e.index}}},{key:"inputEnter",value:function(){l.call(this)}},{key:"initSpan",value:function(e){if(e&&e.length){var t=e[e.length-1].ele;if(r.isNormalSpan(t))return{isOld:!0}}var i=document.createElement("span");i.setAttribute("class","medit-span-text");var n=++this.eleIndex;return i.setAttribute("data-meditIndex",n),{ele:i,index:n}}},{key:"render",value:function(){}}]),e}();window.Medit||(window.medit=window.Medit=d)},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(){function e(t,i){n(this,e),this.isPrevent=!1,this.config=i||{},this.buffer=this.config.buffer||10,t.addEventListener("touchstart",this.touchStart.bind(this)),t.addEventListener("touchend",this.touchEnd.bind(this)),t.addEventListener("touchmove",this.touchMove.bind(this))}return s(e,[{key:"setPrevent",value:function(e){this.isPrevent=e}},{key:"_prevent",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"touchStart",value:function(e){this.posi={startX:e.touches[0].pageX,startY:e.touches[0].pageY,endX:e.touches[0].pageX,endY:e.touches[0].pageY,verticalDistance:0,horizontalDistance:0,target:e.target}}},{key:"touchMove",value:function(e){this.posi.endX=e.touches[0].pageX,this.posi.endY=e.touches[0].pageY,this.posi.horizontalDistance=this.posi.endX-this.posi.startX,this.posi.horizontal=this.posi.horizontalDistance>0?"right":"left",this.posi.verticalDistance=this.posi.endY-this.posi.startY,this.posi.vertical=this.posi.verticalDistance>0?"bottom":"top",this.config.move&&this.config.move(this.posi)}},{key:"touchEnd",value:function(e){Math.abs(this.posi.verticalDistance)<this.buffer&&Math.abs(this.posi.horizontalDistance)<this.buffer?this.config.click&&this.config.click(this.posi):(this._prevent(e),this.config.moveEnd&&this.config.moveEnd(this.posi))}}]),e}();e.exports=a},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(){function e(t,i){n(this,e),this.input=t,this.config=i||{},this.input.onblur=this.blur.bind(this,!0),this.input.onfocus=this.focus.bind(this,!0),this.input.onkeydown=this.keydown.bind(this)}return s(e,[{key:"blur",value:function(e){-1!=this.input.className.indexOf("medit-span-text-edit")&&this.input.setAttribute("class",this.input.className.replace(" medit-span-text-edit","")),e||(this.config.blur&&this.config.blur(),this.input.blur())}},{key:"focus",value:function(e){var t=this;this.input.setAttribute("contenteditable",!0),-1==this.input.className.indexOf("medit-span-text-edit")&&this.input.setAttribute("class",this.input.className+" medit-span-text-edit"),e||setTimeout(function(){t.input.focus()},10)}},{key:"keydown",value:function(e){"enter"==e.key.toLowerCase()&&(e.preventDefault(),e.stopPropagation(),this.blur(),this.config.enter&&this.config.enter())}}]),e}();e.exports=a},function(e,t,i){"use strict";var n=/(font\-style\s*:\s*normal\s*;)|(font\-weight\s*:\s*normal\s*;)|(color:\s*rgb\(0,\s*0,\s*0\);)|(\s*)/gi,s={};s.isNormalSpan=function(e){if("span"!=e.nodeName.toLowerCase())return!1;var t=e.getAttribute("style");return!t||!t.replace(n,"")},s.getIndex=function(e,t){if(t){for(var i=t,n=t.getAttribute("data-meditIndex");i&&"p"!=i.nodeName.toLowerCase();)i=i.parentNode;if(i){for(var s=i.getAttribute("data-meditIndex"),a=0,o=0,r=0;r<e.length;r++)if(e[r].index==s){a=r;break}for(var h=e[a].child,l=0;l<h.length;l++)if(h[l].index==n){o=l;break}return{lineIndex:a,childIndex:o}}}},e.exports=s},function(e,t,i){"use strict";var n={};n.getCaretPos=function(e){var t,i,n=0;if(window.getSelection)t=window.getSelection(),t.rangeCount&&(i=t.getRangeAt(0),i.commonAncestorContainer.parentNode==e&&(n=i.endOffset));else if(document.selection&&document.selection.createRange&&(i=document.selection.createRange(),i.parentElement()==e)){var s=document.createElement("span");e.insertBefore(s,e.firstChild);var a=i.duplicate();a.moveToElementText(s),a.setEndPoint("EndToEnd",i),n=a.text.length}return n},n.setCaretPos=function(e,t){var i=window.getSelection(),n=document.createRange();n.selectNode(e),n.setStart(e.childNodes[0],0),n.setEnd(e.childNodes[0],t),n.collapse(!1),i.removeAllRanges(),i.addRange(n)},n.getElement=function(e,t,i,n,s){var a=e[t].child[i].ele.innerText.length,o=n+s;if(o>=0&&o<=a)return{ele:e[t].child[i].ele,lineIndex:t,childIndex:i,pos:o};if(o<0)for(var r=t;r>=0;r--){var h=e[r].child,l=h.length-1;r==t&&(l=i-1);for(var d=l;d>=0;d--){var c=h[d].ele;if(-1!=c.className.indexOf("medit-span-text")){var u=c.innerText.length;if((o+=u)>=0)return{ele:c,lineIndex:r,childIndex:d,pos:o+1}}}}else for(var f=t;f<e.length;f++){var p=e[f].child,x=0;f==t&&(x=i);for(var v=x;v<p.length;v++){var g=p[v].ele;if(-1!=g.className.indexOf("medit-span-text")){var m=g.innerText.length,I=o-m;if(I<=0)return{ele:g,lineIndex:f,childIndex:v,pos:o-1};o-=m}}}},e.exports=n},function(e,t,i){"use strict";var n=function(){var e=this,t=this.data,i=this.lineIndex,n=this.childIndex,s=this._Selection;console.log(i,n,s);var a=t[i].child[n].ele,o=s.getCaretPos(a),r=a.innerText.length;if(n==t[i].child.length-1&&o==r)this.initLine(i+1),this.childIndex=0,this.insertNewSpan();else{var h=n+1;if(o!=r){var l=a.innerText,d=l.substring(0,o),c=l.substring(o,r),u=a.cloneNode(),f=++this.eleIndex;u.innerText=d,u.setAttribute("data-meditIndex",f),a.innerText=c,a.parentNode.insertBefore(u,a),this.data[i].child.splice(n,0,this.insertNewSpanInfo({ele:u,index:f})),h=n}this.initLine(i+1),this.data[this.lineIndex].child=this.data[this.lineIndex-1].child.splice(h+1),this.data[this.lineIndex].child.map(function(t){t.ele.parentNode.removeChild(t.ele),e.data[e.lineIndex].ele.appendChild(t.ele)}),this.data[this.lineIndex].child[0].input.focus()}console.log(this.data)};e.exports=n}]);